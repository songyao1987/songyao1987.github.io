<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>
        
            How to work with Jenkins,Gitlab and Maven &middot; EricSong
        
    </title>

    <script src="/theme/js/jquery-3.4.1.min.js"></script>
    <script src="/theme/js/bootstrap-4.6.0.bundle.min.js"></script>

    <link rel="stylesheet" href="/theme/css/site.css">
    <link rel="stylesheet" href="/theme/css/syntax.css">

</head>


<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top justify-content-between">
    <div class="container">
        <a class="navbar-brand font-weight-bold" href="/index.html">EricSong</a>
        <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarContent" >
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarContent">
            <ul class="navbar-nav ml-auto">
            
                <li class="nav-item">
                    <a href='/index.html'
                       class="nav-link">
                        Home
                    </a>
                </li>
            
                <li class="nav-item">
                    <a href='/about.html'
                       class="nav-link">
                        About
                    </a>
                </li>
            
                <li class="nav-item">
                    <a href='/list/posts.html'
                       class="nav-link">
                        Posts
                    </a>
                </li>
            
                <li class="nav-item">
                    <a href='/list/projects.html'
                       class="nav-link">
                        Documentation
                    </a>
                </li>
            
            </ul>
        </div>
    </div>
</nav>





<div class="container site-container" id="top">
    <div class="row">
        <div class="d-none d-lg-block col-lg-4 col-xl-4 side">
            








    <div class="sticky-top space-before">
    <div class="card bg-light mb-3">
        <div class="card-body">
            <div class="card-title">
                <h5>17 Jan 2020</h5>
            </div>
            <div class="d-flex flex-wrap align-items-center">
                <span class="icon grey mr-2 mb-2">
                    <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 18.1.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->

<svg version="1.1" id="Price_tag" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
<g>
	<path d="M19.388,0.405c-0.111-0.314-0.454-0.48-0.769-0.371c-0.315,0.109-0.481,0.455-0.372,0.77
		c0.929,2.67-0.915,4.664-2.321,5.732l-0.568-0.814c-0.191-0.273-0.618-0.5-0.95-0.504L11.22,5.232
		c-0.332-0.006-0.825,0.146-1.097,0.338l-9.394,6.587c-0.455,0.32-0.565,0.947-0.247,1.404l4.269,6.108
		c0.32,0.455,0.831,0.4,1.287,0.082l9.394-6.588c0.27-0.191,0.582-0.603,0.692-0.918l0.998-3.145
		c0.11-0.314,0.043-0.793-0.148-1.066l-0.346-0.496C18.516,6.091,20.476,3.534,19.388,0.405z M15.017,9.763
		c-0.727,0.51-1.731,0.332-2.24-0.396c-0.511-0.73-0.333-1.734,0.395-2.246C13.75,6.716,14.5,6.745,15.04,7.138
		c-0.272,0.164-0.459,0.26-0.494,0.275c-0.301,0.143-0.43,0.504-0.288,0.805c0.104,0.219,0.321,0.348,0.547,0.348
		c0.086,0,0.174-0.02,0.257-0.059c0.194-0.092,0.402-0.201,0.619-0.33C15.778,8.771,15.542,9.394,15.017,9.763z"/>
</g>
</svg>

                </span>
                
                    <a href="/list/posts.html#jenkins"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        Jenkins
                    </a>
                
                    <a href="/list/posts.html#cicd"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        CICD
                    </a>
                
                    <a href="/list/posts.html#maven"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        Maven
                    </a>
                
                    <a href="/list/posts.html#gitlab"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        Gitlab
                    </a>
                
                    <a href="/list/posts.html#android"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        Android
                    </a>
                
                    <a href="/list/posts.html#groovy"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        Groovy
                    </a>
                
                    <a href="/list/posts.html#java"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        Java
                    </a>
                
            </div>
            <div class="d-flex align-items-center mt-2">
                <span class="icon grey mr-1">
                    <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 18.1.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->

<svg version="1.1" id="Arrow_left" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
<path d="M2.5,10L9,3.5V7h8v6H9v3.5L2.5,10z"/>
</svg>

                </span>
                <a href="/list/posts.html">Back to all posts</a>
            </div>
        </div>
    </div>
</div>




        </div>
        <div class="col-md-12 col-lg-8 col-xl-8 pb-4 content">
            <h1 class="border border-top-0 border-right-0 border-left-0 mb-3 pb-2">How to work with Jenkins,Gitlab and Maven</h1>

<div class="d-md-block d-lg-none">
    <div class="sticky-top space-before">
    <div class="card bg-light mb-3">
        <div class="card-body">
            <div class="card-title">
                <h5>17 Jan 2020</h5>
            </div>
            <div class="d-flex flex-wrap align-items-center">
                <span class="icon grey mr-2 mb-2">
                    <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 18.1.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->

<svg version="1.1" id="Price_tag" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
<g>
	<path d="M19.388,0.405c-0.111-0.314-0.454-0.48-0.769-0.371c-0.315,0.109-0.481,0.455-0.372,0.77
		c0.929,2.67-0.915,4.664-2.321,5.732l-0.568-0.814c-0.191-0.273-0.618-0.5-0.95-0.504L11.22,5.232
		c-0.332-0.006-0.825,0.146-1.097,0.338l-9.394,6.587c-0.455,0.32-0.565,0.947-0.247,1.404l4.269,6.108
		c0.32,0.455,0.831,0.4,1.287,0.082l9.394-6.588c0.27-0.191,0.582-0.603,0.692-0.918l0.998-3.145
		c0.11-0.314,0.043-0.793-0.148-1.066l-0.346-0.496C18.516,6.091,20.476,3.534,19.388,0.405z M15.017,9.763
		c-0.727,0.51-1.731,0.332-2.24-0.396c-0.511-0.73-0.333-1.734,0.395-2.246C13.75,6.716,14.5,6.745,15.04,7.138
		c-0.272,0.164-0.459,0.26-0.494,0.275c-0.301,0.143-0.43,0.504-0.288,0.805c0.104,0.219,0.321,0.348,0.547,0.348
		c0.086,0,0.174-0.02,0.257-0.059c0.194-0.092,0.402-0.201,0.619-0.33C15.778,8.771,15.542,9.394,15.017,9.763z"/>
</g>
</svg>

                </span>
                
                    <a href="/list/posts.html#jenkins"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        Jenkins
                    </a>
                
                    <a href="/list/posts.html#cicd"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        CICD
                    </a>
                
                    <a href="/list/posts.html#maven"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        Maven
                    </a>
                
                    <a href="/list/posts.html#gitlab"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        Gitlab
                    </a>
                
                    <a href="/list/posts.html#android"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        Android
                    </a>
                
                    <a href="/list/posts.html#groovy"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        Groovy
                    </a>
                
                    <a href="/list/posts.html#java"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        Java
                    </a>
                
            </div>
            <div class="d-flex align-items-center mt-2">
                <span class="icon grey mr-1">
                    <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 18.1.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->

<svg version="1.1" id="Arrow_left" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
<path d="M2.5,10L9,3.5V7h8v6H9v3.5L2.5,10z"/>
</svg>

                </span>
                <a href="/list/posts.html">Back to all posts</a>
            </div>
        </div>
    </div>
</div>

</div>

<p>First of all, we need to install jenkins as the following steps.
<!--more-->
Step 1: install JDK, and we can check it with command “java –version”</p>

<p>Step 2: install android SDK and android NDK if you are working in Android projects</p>

<p>Step 3: install Jenkins
Add the key from official software repository to the apt key in locall</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">wget</span> <span class="o">-</span><span class="nx">q</span> <span class="o">-</span><span class="nx">O</span> <span class="o">-</span> <span class="nx">https</span><span class="p">:</span><span class="c1">//pkg.jenkins.io/debian-stable/jenkins.io.key | sudo apt-key add -</span></code></pre></figure>

<p>Add the address to your locall list</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">sudo</span> <span class="nx">sh</span> <span class="o">-</span><span class="nx">c</span> <span class="dl">'</span><span class="s1">echo deb https://pkg.jenkins.io/debian-stable binary/ &gt; /etc/apt/sources.list.d/jenkins.list</span><span class="dl">'</span></code></pre></figure>

<p>Then you can complete the installation of jenkins by the following commands,</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">sudo</span> <span class="nx">apt</span><span class="o">-</span><span class="kd">get</span> <span class="nx">update</span>
<span class="nx">sudo</span> <span class="nx">apt</span><span class="o">-</span><span class="kd">get</span> <span class="nx">install</span> <span class="nx">jenkins</span>
<span class="nx">sudo</span> <span class="o">/</span><span class="nx">etc</span><span class="o">/</span><span class="nx">init</span><span class="p">.</span><span class="nx">d</span><span class="o">/</span><span class="nx">jenkins</span> <span class="p">[</span><span class="nx">start</span><span class="o">|</span><span class="nx">restart</span><span class="o">|</span><span class="nx">stop</span><span class="p">]</span>
<span class="nx">systemctl</span> <span class="nx">status</span> <span class="nx">jenkins</span></code></pre></figure>

<p>Now we can try to access the home page of jenkins and you can see the login required as below.
<!-- ![](/assets/images/jenkins_login.png) --></p>

<p><img src="/assets/images/jenkins_login.png" alt="Login" style="width:525px;height:480px;" /></p>

<p>Secondly, we need to complete some configurations and install a few plugins in jenkins page,just like gradle,gitlab,email,pipeline(strong recommended),webhook.etc.In addition,we also need to config environment varibles in System configurations and learning how to write jenkinsfile with Groovy.Anyway the multibranch pipeline mode is strongly recommended.
Below is a jenkinsfile sample for building an android APK:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">def</span> <span class="n">gradleproperties</span> <span class="o">=</span> <span class="s">"""
    MAVEN_REPO_SNAPSHOTS_URL=http://127.0.0.1:8081/repository/maven-snapshots/
    MAVEN_REPO_RELEASES_URL=http://127.0.0.1:8081/repository/maven-releases/
    MAVEN_REPO_USERNAME=admin
    MAVEN_REPO_PASSWORD=admin
    SIGNPASS=123456
    SIGNCERT=/home/ubuntu/ApkSignCert/demoapp.jks

pipeline {
    agent any
    stages {
        stage('Build') {
          steps {
              sh """</span>
              <span class="err">#</span><span class="n">mkdir</span> <span class="o">/</span><span class="n">root</span><span class="o">/.</span><span class="na">gradle</span>
              <span class="n">echo</span> <span class="err">'$</span><span class="o">{</span><span class="n">gradleproperties</span><span class="o">}</span><span class="err">'</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">root</span><span class="o">/.</span><span class="na">gradle</span><span class="o">/</span><span class="n">gradle</span><span class="o">.</span><span class="na">properties</span>
              <span class="s">""</span><span class="err">"</span>
              <span class="n">sh</span> <span class="err">'</span><span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="n">gradlew</span><span class="err">'</span>
              <span class="n">sh</span> <span class="err">'</span><span class="o">./</span><span class="n">gradlew</span> <span class="n">clean</span> <span class="n">build</span> <span class="o">-</span><span class="n">x</span> <span class="n">check</span> <span class="n">pmd</span><span class="err">'</span>
            <span class="o">}</span>
          <span class="o">}</span>
        <span class="n">stage</span><span class="o">(</span><span class="err">'</span><span class="nc">Archive</span><span class="err">'</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">steps</span> <span class="o">{</span>
                <span class="n">archiveArtifacts</span> <span class="err">'</span><span class="n">app</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">outputs</span><span class="cm">/**/</span><span class="o">*.</span><span class="na">apk</span><span class="err">'</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">stage</span><span class="o">(</span><span class="err">'</span><span class="nc">Test</span><span class="err">'</span><span class="o">)</span> <span class="o">{</span>
              <span class="n">steps</span> <span class="o">{</span>
                  <span class="n">echo</span> <span class="err">'</span><span class="nc">Testing</span><span class="o">..</span><span class="err">'</span>
              <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">options</span> <span class="o">{</span>
      <span class="n">gitLabConnection</span><span class="o">(</span><span class="err">'</span><span class="nc">Connection2Gitlab</span><span class="err">'</span><span class="o">)</span>
  	<span class="o">}</span>
    <span class="n">post</span> <span class="o">{</span>
      <span class="n">failure</span> <span class="o">{</span>
        <span class="n">updateGitlabCommitStatus</span> <span class="nl">name:</span> <span class="err">'</span><span class="nc">Connection2Gitlab</span><span class="err">'</span><span class="o">,</span> <span class="nl">state:</span> <span class="err">'</span><span class="n">failed</span><span class="err">'</span>
      <span class="o">}</span>
      <span class="n">success</span> <span class="o">{</span>
        <span class="n">updateGitlabCommitStatus</span> <span class="nl">name:</span> <span class="err">'</span><span class="nc">Connection2Gitlab</span><span class="err">'</span><span class="o">,</span> <span class="nl">state:</span> <span class="err">'</span><span class="n">success</span><span class="err">'</span>
      <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>Finally you can see the artifact in build page and can download by manual.Moreover, we can deploy private Maven repository if we need to publish android libraries(Jar/aar),you just need to add a stage in jenkinsfile for publishing artifact to your Maven repository.So your Application can pull the anroid libraries from your Maven repository with credentials you set in Maven.</p>

<p>Add configs in the root build.gradle</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">allprojects</span> <span class="p">{</span>

    <span class="nx">repositories</span> <span class="p">{</span>
		<span class="nx">jcenter</span><span class="p">()</span>
		<span class="nx">google</span><span class="p">()</span>
		<span class="nx">mavenCentral</span><span class="p">()</span>
    <span class="p">}</span>
	<span class="nx">maven</span> <span class="p">{</span>
		<span class="nx">url</span> <span class="nx">MAVEN_REPO_SNAPSHOTS_URL</span>
		<span class="nx">credentials</span> <span class="p">{</span>
			<span class="nx">username</span> <span class="nx">MAVEN_REPO_USERNAME</span>
			<span class="nx">password</span> <span class="nx">MAVEN_REPO_PASSWORD</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="nx">maven</span> <span class="p">{</span>
		<span class="nx">url</span> <span class="nx">MAVEN_REPO_RELEASES_URL</span>
		<span class="nx">credentials</span> <span class="p">{</span>
			<span class="nx">username</span> <span class="nx">MAVEN_REPO_USERNAME</span>
			<span class="nx">password</span> <span class="nx">MAVEN_REPO_PASSWORD</span>
		<span class="p">}</span>
	<span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>We can install and deply nexus Maven repository as following steps.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">Download</span> <span class="kr">package</span> <span class="k">from</span> <span class="nx">https</span><span class="p">:</span><span class="c1">//www.sonatype.com/products/repository-oss-download</span>
<span class="nx">tar</span> <span class="o">-</span><span class="nx">zxvf</span>  <span class="nx">nexus</span><span class="o">-</span><span class="mf">3.39</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="nx">bundle</span><span class="p">.</span><span class="nx">tar</span><span class="p">.</span><span class="nx">gz</span>

<span class="c1">//Enablie start service automatically</span>
<span class="nx">cd</span> <span class="o">/</span><span class="nx">etc</span><span class="o">/</span><span class="nx">init</span><span class="p">.</span><span class="nx">d</span>
<span class="nx">sudo</span> <span class="nx">update</span><span class="o">-</span><span class="nx">rc</span><span class="p">.</span><span class="nx">d</span> <span class="nx">nexus</span> <span class="nx">defaults</span>
<span class="nx">sudo</span> <span class="nx">service</span> <span class="nx">nexus</span> <span class="nx">start</span></code></pre></figure>

<p>Now we can publish our android libraries(Jar/aar) to the Maven repository.we can publish snapshots version in our project with command as “gradlew publishToMavenLocal” and publish release version in jenkins with command “gradlew publish”
Below is an example for publish android aar</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">task</span> <span class="nx">sourceJar</span><span class="p">(</span><span class="nx">type</span><span class="p">:</span> <span class="nx">Jar</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">classifier</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">sources</span><span class="dl">'</span>
    <span class="k">from</span> <span class="nx">android</span><span class="p">.</span><span class="nx">sourceSets</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">java</span><span class="p">.</span><span class="nx">srcDirs</span>
<span class="p">}</span>
<span class="nx">apply</span> <span class="nx">plugin</span><span class="p">:</span> <span class="dl">'</span><span class="s1">maven-publish</span><span class="dl">'</span>

<span class="nx">publishing</span> <span class="p">{</span>
    <span class="nx">publications</span> <span class="p">{</span>
        <span class="nx">aar</span><span class="p">(</span><span class="nx">MavenPublication</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">artifactId</span> <span class="o">=</span> <span class="nx">project</span><span class="p">.</span><span class="nx">name</span>
            <span class="c1">//artifact sourceJar</span>
            <span class="nx">artifact</span><span class="p">(</span><span class="dl">"</span><span class="s2">$buildDir/outputs/aar/${project.name}-release-${project.version}.aar</span><span class="dl">"</span><span class="p">)</span>

            <span class="nx">pom</span><span class="p">.</span><span class="nx">withXml</span> <span class="p">{</span>
                <span class="nx">def</span> <span class="nx">dependenciesNode</span> <span class="o">=</span> <span class="nx">asNode</span><span class="p">().</span><span class="nx">appendNode</span><span class="p">(</span><span class="dl">'</span><span class="s1">dependencies</span><span class="dl">'</span><span class="p">)</span>
                <span class="nx">ext</span><span class="p">.</span><span class="nx">addDependency</span> <span class="o">=</span> <span class="p">{</span><span class="nx">Dependency</span> <span class="nx">dep</span><span class="p">,</span> <span class="nb">String</span> <span class="nx">scope</span> <span class="o">-&gt;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">dep</span><span class="p">.</span><span class="nx">group</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">dep</span><span class="p">.</span><span class="nx">version</span> <span class="o">==</span> <span class="kc">null</span>
                            <span class="o">||</span> <span class="nx">dep</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="dl">"</span><span class="s2">unspecified</span><span class="dl">"</span> <span class="o">==</span> <span class="nx">dep</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>
                        <span class="k">return</span>
                    <span class="nx">def</span> <span class="nx">dependency</span> <span class="o">=</span> <span class="nx">dependenciesNode</span><span class="p">.</span><span class="nx">appendNode</span><span class="p">(</span><span class="dl">'</span><span class="s1">dependency</span><span class="dl">'</span><span class="p">)</span>
                    <span class="nx">dependency</span><span class="p">.</span><span class="nx">appendNode</span><span class="p">(</span><span class="dl">'</span><span class="s1">groupId</span><span class="dl">'</span><span class="p">,</span> <span class="nx">dep</span><span class="p">.</span><span class="nx">group</span><span class="p">)</span>
                    <span class="nx">dependency</span><span class="p">.</span><span class="nx">appendNode</span><span class="p">(</span><span class="dl">'</span><span class="s1">artifactId</span><span class="dl">'</span><span class="p">,</span> <span class="nx">dep</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>
                    <span class="nx">dependency</span><span class="p">.</span><span class="nx">appendNode</span><span class="p">(</span><span class="dl">'</span><span class="s1">version</span><span class="dl">'</span><span class="p">,</span> <span class="nx">dep</span><span class="p">.</span><span class="nx">version</span><span class="p">)</span>
                    <span class="nx">dependency</span><span class="p">.</span><span class="nx">appendNode</span><span class="p">(</span><span class="dl">'</span><span class="s1">scope</span><span class="dl">'</span><span class="p">,</span> <span class="nx">scope</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">dep</span><span class="p">.</span><span class="nx">transitive</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">final</span> <span class="nx">exclusion</span> <span class="o">=</span> <span class="nx">dependency</span><span class="p">.</span><span class="nx">appendNode</span><span class="p">(</span><span class="dl">'</span><span class="s1">exclusions</span><span class="dl">'</span><span class="p">).</span><span class="nx">appendNode</span><span class="p">(</span><span class="dl">'</span><span class="s1">exclusion</span><span class="dl">'</span><span class="p">)</span>
                        <span class="nx">exclusion</span><span class="p">.</span><span class="nx">appendNode</span><span class="p">(</span><span class="dl">'</span><span class="s1">groupId</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">*</span><span class="dl">'</span><span class="p">)</span>
                        <span class="nx">exclusion</span><span class="p">.</span><span class="nx">appendNode</span><span class="p">(</span><span class="dl">'</span><span class="s1">artifactId</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">*</span><span class="dl">'</span><span class="p">)</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">dep</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">excludeRules</span><span class="p">.</span><span class="nx">empty</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">final</span> <span class="nx">exclusion</span> <span class="o">=</span> <span class="nx">dependency</span><span class="p">.</span><span class="nx">appendNode</span><span class="p">(</span><span class="dl">'</span><span class="s1">exclusions</span><span class="dl">'</span><span class="p">).</span><span class="nx">appendNode</span><span class="p">(</span><span class="dl">'</span><span class="s1">exclusion</span><span class="dl">'</span><span class="p">)</span>
                        <span class="nx">dep</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">excludeRules</span><span class="p">.</span><span class="nx">each</span> <span class="p">{</span> <span class="nx">ExcludeRule</span> <span class="nx">rule</span> <span class="o">-&gt;</span>
                            <span class="nx">exclusion</span><span class="p">.</span><span class="nx">appendNode</span><span class="p">(</span><span class="dl">'</span><span class="s1">groupId</span><span class="dl">'</span><span class="p">,</span> <span class="nx">rule</span><span class="p">.</span><span class="nx">group</span> <span class="p">?:</span> <span class="dl">'</span><span class="s1">*</span><span class="dl">'</span><span class="p">)</span>
                            <span class="nx">exclusion</span><span class="p">.</span><span class="nx">appendNode</span><span class="p">(</span><span class="dl">'</span><span class="s1">artifactId</span><span class="dl">'</span><span class="p">,</span> <span class="nx">rule</span><span class="p">.</span><span class="nx">module</span> <span class="p">?:</span> <span class="dl">'</span><span class="s1">*</span><span class="dl">'</span><span class="p">)</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>

                <span class="nx">configurations</span><span class="p">.</span><span class="nx">compile</span><span class="p">.</span><span class="nx">getDependencies</span><span class="p">().</span><span class="nx">each</span> <span class="p">{</span> <span class="nx">dep</span> <span class="o">-&gt;</span> <span class="nx">addDependency</span><span class="p">(</span><span class="nx">dep</span><span class="p">,</span> <span class="dl">"</span><span class="s2">compile</span><span class="dl">"</span><span class="p">)</span> <span class="p">}</span>
                <span class="nx">configurations</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">getDependencies</span><span class="p">().</span><span class="nx">each</span> <span class="p">{</span> <span class="nx">dep</span> <span class="o">-&gt;</span> <span class="nx">addDependency</span><span class="p">(</span><span class="nx">dep</span><span class="p">,</span> <span class="dl">"</span><span class="s2">compile</span><span class="dl">"</span><span class="p">)</span> <span class="p">}</span>
                <span class="nx">configurations</span><span class="p">.</span><span class="nx">implementation</span><span class="p">.</span><span class="nx">getDependencies</span><span class="p">().</span><span class="nx">each</span> <span class="p">{</span> <span class="nx">dep</span> <span class="o">-&gt;</span> <span class="nx">addDependency</span><span class="p">(</span><span class="nx">dep</span><span class="p">,</span> <span class="dl">"</span><span class="s2">runtime</span><span class="dl">"</span><span class="p">)</span> <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">repositories</span> <span class="p">{</span>
        <span class="nx">maven</span> <span class="p">{</span>
            <span class="nx">url</span> <span class="o">=</span> <span class="nx">version</span><span class="p">.</span><span class="nx">endsWith</span><span class="p">(</span><span class="dl">"</span><span class="s2">SNAPSHOT</span><span class="dl">"</span><span class="p">)</span> <span class="p">?</span> <span class="nx">MAVEN_REPO_SNAPSHOTS_URL</span> <span class="p">:</span> <span class="nx">MAVEN_REPO_RELEASES_URL</span>
            <span class="nx">credentials</span> <span class="p">{</span>
                <span class="nx">username</span> <span class="nx">MAVEN_REPO_USERNAME</span>
                <span class="nx">password</span> <span class="nx">MAVEN_REPO_PASSWORD</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">tasks</span><span class="p">.</span><span class="nx">withType</span><span class="p">(</span><span class="nx">PublishToMavenLocal</span><span class="p">).</span><span class="nx">each</span> <span class="p">{</span>
    <span class="nx">task</span> <span class="o">-&gt;</span> <span class="nx">task</span><span class="p">.</span><span class="nx">dependsOn</span><span class="p">(</span><span class="dl">'</span><span class="s1">assembleRelease</span><span class="dl">'</span><span class="p">)</span>
<span class="p">}</span>
<span class="nx">tasks</span><span class="p">.</span><span class="nx">withType</span><span class="p">(</span><span class="nx">PublishToMavenRepository</span><span class="p">).</span><span class="nx">each</span> <span class="p">{</span>
    <span class="nx">task</span> <span class="o">-&gt;</span> <span class="nx">task</span><span class="p">.</span><span class="nx">dependsOn</span><span class="p">(</span><span class="dl">'</span><span class="s1">assembleRelease</span><span class="dl">'</span><span class="p">,</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">withType</span><span class="p">(</span><span class="nx">PublishToMavenLocal</span><span class="p">))</span>
<span class="p">}</span></code></pre></figure>

<p>Anyway we can schedule build task in jenkins and let it auto build when new release branch or tag was created in Gitlab,Jenkins will excute stage build,stage publish to Maven, stage unit test ,stage javadoc, stage notify Gitlab and email to maintainers,etc.</p>

<p><img src="https://images.unsplash.com/photo-1658188920091-8d38c64bcb79?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=464&amp;q=80" /></p>



        </div>
        <div class="col-md-12 d-lg-none bottom">
            

        </div>
    </div>
</div>

<script type="text/javascript">
/*!
 * IE10 viewport hack for Surface/desktop Windows 8 bug
 * Copyright 2014-2017 The Bootstrap Authors
 * Copyright 2014-2017 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */

// See the Getting Started docs for more information:
// https://getbootstrap.com/getting-started/#support-ie10-width

(function () {
    'use strict'

    if (navigator.userAgent.match(/IEMobile\/10\.0/)) {
        var msViewportStyle = document.createElement('style')
        msViewportStyle.appendChild(
            document.createTextNode(
                '@-ms-viewport{width:auto!important}'
            )
        )
        document.head.appendChild(msViewportStyle)
    }
}())
</script>

</body>

</html>
